<html lang="de" ng-app="todotxt">

<head>
  <title>Todos</title>
  <base href="/">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.2/css/all.css" integrity="sha384-/rXc/GQVaYpyDdyxK+ecHPVYJSN9bmVFBvjA/9eOB+pb3F2w2N6fc5qB9Ew5yIns"
    crossorigin="anonymous">
  <link rel="stylesheet" href="index.css" />
</head>

<body>
  <div class="container" ng-controller="todotxt-Main as ctrl">
    <h1>Todos <small>{{ctrl.filterSettings}}</small></h1>
    <button id="btnFilters" class="btn btn-primary" type="button" data-toggle="collapse" data-target="#filters"
      aria-expanded="false" aria-controls="filters">
      Filters
    </button>
    <div class="collapse card-body" id="filters">
      <div class="input-group mb-3">
        <div class="input-group-prepend">
          <label class="input-group-text" id="filter-limit">Limit:</label>
        </div>
        <input type="number" class="form-control" ng-model="ctrl.limit" aria-label="Limit" aria-describedby="filter-limit"
          ng-change="ctrl.updateFilter()" />
      </div>
      <div class="input-group mb-3">
        <div class="input-group-prepend">
          <label class="input-group-text" id="filter-context">Context:</label>
        </div>
        <select class="custom-select form-control" ng-model="ctrl.contextFilter" aria-label="contextFilter"
          aria-describedby="filter-context" ng-change="ctrl.updateFilter()">
          <option value="">--- Auswahl ---</option>
          <option ng-repeat="option in ctrl.contexts" value="{{option}}">{{option}}</option>
        </select>
      </div>
      <div class="input-group mb-3">
        <div class="input-group-prepend">
          <label class="input-group-text" id="filter-project">Project:</label>
        </div>
        <select class="custom-select form-control" ng-model="ctrl.projectFilter" aria-label="projectFilter"
          aria-describedby="filter-project" ng-change="ctrl.updateFilter()">
          <option value="">--- Auswahl ---</option>
          <option ng-repeat="option in ctrl.projects" value="{{option}}">{{option}}</option>
        </select>
      </div>
      <div class="input-group mb-3">
        <div class="input-group-prepend">
          <label class="input-group-text" id="filter-priority">Priority:</label>
        </div>
        <select class="custom-select form-control" ng-model="ctrl.priorityFilter" aria-label="priorityFilter"
          aria-describedby="filter-priority" ng-change="ctrl.updateFilter()">
          <option value="">--- Auswahl ---</option>
          <option ng-repeat="option in ctrl.priorities" value="{{option}}">{{option}}</option>
        </select>
      </div>
      <div class="input-group mb-3">
        <div class="input-group-prepend">
          <label class="input-group-text" id="hideCompleted">Hide Completed:</label>
        </div>
        <label class="toggle-check form-control">
          <input type="checkbox" class="toggle-check-input" ng-model="ctrl.hideCompleted" ng-change="ctrl.updateFilter()" />
          <span class="toggle-check-text"></span>
        </label>
      </div>
    </div>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>
            <a class="btn btn-link" ng-click="ctrl.sortType = 'complete'; ctrl.sortReverse = !ctrl.sortReverse">
              Complete
              <span ng-show="ctrl.sortType == 'complete' && !ctrl.sortReverse" class="fa fa-caret-down"></span>
              <span ng-show="ctrl.sortType == 'complete' && ctrl.sortReverse" class="fa fa-caret-up"></span>
          </th>
          <th>
            <a class="btn btn-link" ng-click="ctrl.sortType = 'priority'; ctrl.sortReverse = !ctrl.sortReverse">
              Priority
              <span ng-show="ctrl.sortType == 'priority' && !ctrl.sortReverse" class="fa fa-caret-down"></span>
              <span ng-show="ctrl.sortType == 'priority' && ctrl.sortReverse" class="fa fa-caret-up"></span>
          </th>
          <th>Task</th>
          <th>Details</th>
          <th>
            <a class="btn btn-link" ng-click="ctrl.sortType = 'projects'; ctrl.sortReverse = !ctrl.sortReverse">
              Projects
              <span ng-show="ctrl.sortType == 'projects' && !ctrl.sortReverse" class="fa fa-caret-down"></span>
              <span ng-show="ctrl.sortType == 'projects' && ctrl.sortReverse" class="fa fa-caret-up"></span>
          </th>
          <th>
            <a class="btn btn-link" ng-click="ctrl.sortType = 'context'; ctrl.sortReverse = !ctrl.sortReverse">
              Context
              <span ng-show="ctrl.sortType == 'context' && !ctrl.sortReverse" class="fa fa-caret-down"></span>
              <span ng-show="ctrl.sortType == 'context' && ctrl.sortReverse" class="fa fa-caret-up"></span>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="task in ctrl.tasks | orderBy:ctrl.sortType:ctrl.sortReverse | filter: {contexts:ctrl.contextFilter, projects:ctrl.projectFilter, priority:ctrl.priorityFilter} | limitTo:ctrl.limit"
          ng-class="{'done': task.complete, 'text-muted': task.complete}" ng-hide="ctrl.hideCompleted && task.complete">
          <td>
            <i class="far fa-check-circle" ng-if="task.complete"></i>
            <i class="far fa-circle" ng-if="!task.complete" ng-click="ctrl.complete(task)" style="cursor: pointer;"></i>
          </td>
          <td>{{task.priority}}</td>
          <td>{{task.cleantext}}</td>
          <td><a ng-href="{{task.notes}}" target="_blank">Notes</a></td>
          <td>{{task.projects | join:', '}}</td>
          <td>{{task.contexts | join:', '}}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.7.5/angular.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.7.5/angular-cookies.min.js"></script>
  <script src="index.js"></script>
</body>

</html>